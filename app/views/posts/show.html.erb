<section class="show-post-page">
  <div class="show-post-header p-4">
    <div class="container">
      <div class="d-flex justify-content-between">
        <div class="header-title">
          <h1><%= @post.title %></h1>
        </div>
        <div class="header-btn">
          <%= render "shared/collect_btn", object: @post %>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="post-content p-3">
      <div class="row">
        <div class="col-md-3 text-center user-info" data-link="<%= user_path(@post.user) %>">
          <figure>
            <%= image_tag @post.user.avatar, size: "150" %>
          </figure>
          <p><%= @post.user.name %></p>
          <%= render "shared/add_friend", object: @post %>
        </div>
        <div class="col-md-9">
          <figure>
            <%= image_tag @post.photo if @post.photo %>
          </figure>
          <p><%= @post.description %></p>
          <div class="edit-btn">
            <%= link_to fa_icon("pencil"), edit_post_path(@post), class: "btn btn-custom" if current_user == @post.user %>
            <%= link_to fa_icon("times"), post_path(@post), method: :delete, class: "btn btn-danger" if current_user == @post.user || current_user.role == "admin" %>
          </div>
        </div>
      </div>
    </div>
    
    <div class="reply-block p-3">
      <% @replies.each do |reply| %>
      <div class="reply-content p-3">
        <div class="row">
          <div class="col-md-3 text-center user-info" data-link="<%= user_path(reply.user) %>">
            <figure>
              <%= image_tag reply.user.avatar, size: "150" %>
            </figure>
            <p><%= reply.user.name %></p>
            <%= render "shared/add_friend", object: reply %>
          </div>
          <div class="col-md-9">
            <p><%= reply.comment %></p>

            <%= link_to "add friend", friend_requests_path(friend_id: reply.user), method: :post unless current_user == reply.user || !current_user.friends.include?(reply.user) %>

            <div class="edit-btn">
              <% if current_user == reply.user %>
                <%= link_to fa_icon("pencil"), edit_post_reply_path(@post, reply), class: "btn btn-dark" %>
                <%= link_to fa_icon("times"), post_reply_path(@post, reply), method: :delete, class: "btn btn-danger" %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
      <% end %>
      <%= paginate @replies %>
    </div>
    
    <div class="reply-form p-5">
      <%= form_for [@post, @reply] do |f| %>
        <div class="form-group">
          <%= f.text_area :comment,placeholder: "add comment", resize: false, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.submit "Submit", class: "btn btn-custom" %>
        </div>
      <% end %>
    </div>
  </div>
</section>


